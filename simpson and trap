#include <stdio.h>
#include <math.h>

#define F 500.0
#define A 2.5
#define N 1000

double y_star(double x)
{
    return (A * x) / (1.0 + (A - 1.0) * pow(x, 0.98));
}

double f(double x)
{
    return 1.0 / (y_star(x) - x);
}

double Simpson(double a, double b, int n)
{
    if (n % 2 != 0)
        n++;

    double h = (b - a) / n;
    double sum = f(a) + f(b);

    for (int i = 1; i < n; i++)
    {
        double x = a + i * h;
        if (i % 2 == 0)
            sum += 2 * f(x);
        else
            sum += 4 * f(x);
    }

    return (h / 3.0) * sum;
}

double trapezoidal(double a, double b, int n)
{
    double h = (b - a) / n;
    double sum = 0.5 * (f(a) + f(b));

    for (int i = 1; i < n; i++)
    {
        double x = a + i * h;
        sum += f(x);
    }

    return h * sum;
}

int main()
{
    double xw = 0.03;
    double xf = 0.20;

    double integral_simpson = Simpson(xw, xf, N);
    double integral_trap = trapezoidal(xw, xf, N);

    double W_simpson = F / exp(integral_simpson);
    double W_trap = F / exp(integral_trap);

    printf("Integral by Simpson = %f\n", integral_simpson);
    printf("Integral by Trapezoidal = %f\n", integral_trap);

    printf("W (Simpson) = %f moles\n", W_simpson);
    printf("W (Trapezoidal) = %f moles\n", W_trap);

    return 0;
}
